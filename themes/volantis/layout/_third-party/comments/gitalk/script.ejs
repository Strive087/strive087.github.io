<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
<script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
<script type="text/javascript">
  function pjax_gitalk() {
    console.log(document.getElementById('gitalk-container'));
    if (document.getElementById('gitalk-container') != null) {
      var gitalk = new Gitalk({
        clientID: "<%- theme.comments.gitalk.clientID %>",
        clientSecret: "<%- theme.comments.gitalk.clientSecret %>",
        repo: "<%- theme.comments.gitalk.repo %>",
        owner: "<%- theme.comments.gitalk.owner %>",
        admin: "<%- theme.comments.gitalk.admin %>",
        <% if(page.gitalk && page.gitalk.id) { %>
          id: "<%= page.gitalk.id %>",
        <% } else { %>
          id: decodeURI(location.pathname),      // Ensure uniqueness and length less than 50
        <% } %>
        distractionFreeMode: false  // Facebook-like distraction free mode
      });
      gitalk.render('gitalk-container');
    }
  }

  $(function () {
    pjax_gitalk();
  });
</script>
